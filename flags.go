package main

import (
	"regexp"
	"strconv"
	"strings"
)

func processFlags(flags string) []string {
	var flagres []string
	flagres = strings.Split(flags, ",")
	return flagres
}

func processPorts(ports string) []string {
	var portsres []string
	portsres = strings.Split(ports, "\n")
	return portsres
}

func processRegExp(urls []string) []string {
	// Basic variables setup
	var ip4urls []string
	var ipstring string
	// Main regexp algo
	for _, url := range urls {
		matched, _ := regexp.MatchString("([0-9]{1,3}\\.){3}[0-9]{1,3}", url)
		// If IPv4 we are checking on subnetwork case
		if matched {
			subnetworks := strings.Split(url, "/")
			if len(subnetworks) > 1 {
				switch subnetworks[1] {
				// TODO add subnetworks for the further use-cases
				case "24":
					subnetwork := strings.Split(subnetworks[0], ".")
					for i := 0; i < 256; i++ {
						ipint, _ := strconv.Atoi(subnetwork[3])
						ipint = i
						subnetwork[3] = strconv.Itoa(ipint)
						ipstring = strings.Join(subnetwork, ".")
						ip4urls = append(ip4urls, ipstring)
					}
					return ip4urls
				}
			}
			ip4urls = append(ip4urls, url)
		}
	}
	return ip4urls
}
